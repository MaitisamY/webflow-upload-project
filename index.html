<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: lightgray;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        .upload-product-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr;
            grid-gap: 20px;
            margin-top: 20px;
            margin-bottom: 20px;
            padding: 0;
            width: 100%;
            height: 100%;
            min-height: 90vh;
            max-width: 1280px;
            background: white;
        }

        .left-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-end;
            grid-column: 1 / 2;
            grid-row: 1 / 2;
            padding: 10px;
            gap: 20px;
        }

        .left-container .large-img-box {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            margin: 0 auto;
            width: 100%;
            height: 90%;
            position: relative;
        }

        .left-container .large-img-box img {
            max-width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        .left-container .large-img-box .img-uploader {
            position: absolute;
            top: 75%;
            left: 50%;
            transform: translate(-50%, -70%);
            width: 50%;
            height: fit-content;
            min-height: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            gap: 25px;
            padding: 20px 40px;
            border: 2px solid white;
            background: rgba(8, 36, 42, 0.2);
            color: white;
            border-radius: 5px;
            z-index: 1;
        }

        @media screen and (max-width: 991px) {
            .left-container .large-img-box .img-uploader {
                top: 0;
                left: 50%;
                transform: translate(-50%, 0);
                width: 80%;    
            }
        }

        .left-container .large-img-box .img-uploader .custom-file-input {
            position: relative;
            display: inline-block;
            cursor: pointer;
            background-color: #333;
            color: white;
            border-radius: 8px;
            padding: 7px 14px;
        }

        .left-container .large-img-box .img-uploader .custom-file-input input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .left-container .small-img-box {
            width: 100%;
            height: auto;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            flex-wrap: nowrap;
            overflow-x: hidden;
            overflow-y: hidden;
            -webkit-overflow-scrolling: touch;
            -ms-overflow-style: none;
            gap: 10px;
        }

        .left-container .small-img-box img {
            width: calc(99% / 3);
            height: auto;
            object-fit: cover;
        }

        .left-container .small-img-box.scrollable {
            overflow-x: scroll;
        }

        .left-container .small-img-box::-webkit-scrollbar {
            width: 3px;
            border-radius: 25px;
            background: lightgray;
        }

        .left-container .small-img-box::-webkit-scrollbar-thumb {
            background: gray;
            border-radius: 25px;
        }

        .left-container .small-img-box::-webkit-scrollbar-thumb:hover {
            background: darkgray;
        }

        .right-container {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            grid-column: 2 / 3;
            grid-row: 1 / 2;
            padding: 10px;
        }

        .right-container .intro-container {
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 0;
            padding: 0 10px 15px 10px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .right-container .intro-container h6 {
            font-size: 16px;
            font-weight: 400;
            line-height: 1.5;
            padding: 20px 20px 0 0;
        }

        .rating {
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            align-items: center;
            gap: 3px;
        }

        .right-container .color-selector {
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            gap: 10px;
            padding: 15px 10px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .right-container .color-selector .color {
            width: 100%;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
        }

        .right-container .color-selector .color h5 {
            font-size: 17px;
            font-weight: 500;
        }

        .right-container .color-selector .color .shape {
            width: 30px;
            height: 20px;
            border-radius: 5%;
            outline: 3px solid rgba(255, 255, 255, 1);
            outline-offset: -3px;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
            transform: scale(1.1);
        }

        .right-container .color-selector .color p {
            font-size: 16px;
        }

        .right-container .color-selector .color a {
            display: block;
            border-radius: 50px;
            padding: 5px 10px;
            margin-left: 10px;
            text-decoration: none;
            color: gray;
            font-size: 14px;
            transition: all 0.2s ease-in-out;
            border: 1px solid rgb(189, 189, 189);
            cursor: pointer;
        }

        .right-container .color-selector .color a:visited {
            color: gray;
        }

        .right-container .color-selector .color a:hover {
            color: black;
            border: 1px solid black;
        }

        .right-container .color-selector .color-palette {
            width: 100%;
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .right-container .color-selector .color-palette .shape {
            width: 30px;
            height: 20px;
            border-radius: 5%;
            cursor: pointer;
            outline: 3px solid rgba(255, 255, 255, 1);
            outline-offset: -3px;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
        }

        .right-container .color-selector .color-palette .shape:hover {
            transform: scale(1.1);
        }

        .popup {
            position: absolute;
            background: white;
            border: 1px solid lightgray;
            padding: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 10;
            flex-wrap: wrap;
            gap: 5px;
            width: 200px;
        }

        .popup .shape {
            width: 30px;
            height: 20px;
            cursor: pointer;
        }

        .error-popup {
            position: fixed;
            top: 20px;
            right: -300px;
            width: 300px;
            padding: 10px;
            background: red;
            color: white;
            border-radius: 5px;
            transition: all 0.5s ease-in-out;
        }

        .error-popup.show {
            right: 20px;
        }
    </style>
</head>
<body>
    <div id="upload-product-container" class="upload-product-container">
        <div id="left-container" class="left-container">
            <div id="large-img-box" class="large-img-box">
                <img id="large-img" src="./main-img.png" alt="large image">
                <div class="img-uploader">
                    <img src="./click-icon.png" alt="upload icon">
                    <h4>
                        Drag and drop <br /> Artwork
                    </h4>
                    <div class="custom-file-input">
                        Upload
                        <input type="file" id="file-input" multiple />
                    </div>
                    <p>
                        Supported files: <br />
                        AI, EPS, SVG, PDF, PSD, <br /> PNG, JPG
                    </p>
                </div>
            </div>
            <div id="small-img-box" class="small-img-box">
                <img src="./small-img-1.png" alt="small image">
                <img src="./small-img-2.png" alt="small image">
                <img src="./small-img-3.png" alt="small image">
            </div>
        </div>
        <div id="right-container" class="right-container">
            <div class="intro-container">
                <div class="rating">
                    <img src="./star.png" alt="star">
                    <img src="./star.png" alt="star">
                    <img src="./star.png" alt="star">
                    <img src="./star.png" alt="star">
                    <img src="./star.png" alt="star">
                    <p>(6 customer reviews)</p>
                </div>
                <div>
                    <h1>Product Name</h1>
                    <h4>100 pieces at $10*</h4>
                    <p>*pricing includes 1 color front print</p>
                </div>
                <h6>
                    Accusamus quia dolor et non voluptas similique. 
                    Omnis doloribus voluptatem nihil minus similique. 
                    Fugit mollitia et expedita occaecati est qui sit. 
                    Accusamus quia dolor et non voluptas similique. 
                    Omnis doloribus voluptatem nihil minus similique. 
                    Fugit mollitia et expedita occaecati est qui sit.
                </h6>
            </div>
            <div class="color-selector">
                <div class="color">
                    <h5>Color: </h5>
                    <div class="shape" id="selected-color" style="background: #F4F4F4;"></div>
                    <p>Selected Color</p>
                    <a id="show-palette">Show color palette</a>
                </div>
                <div class="color-palette" id="initial-palette">
                </div>
                <div class="popup" id="popup-palette">
                    <!-- Popup colors will be generated by JS -->
                </div>
            </div>
        </div>
    </div>
    <div id="error-popup" class="error-popup"></div>
    <script>
            const colorPalette = [
                "#EA7164",
                "#D98979",
                "#D4CBC8",
                "#E59E7C",
                "#DCB780",
                "#E2BD61",
                "#E9D79A",
                "#888780",
                "#8A8779",
                "#34997B",
                "#86CEE2",
                "#37B8E0",
                "#B7CAD7",
                "#9DB2CB",
                "#5E6573",
                "#426EC2",
                "#666C80",
                "#7F89C9",
                "#8269B3",
                "#B3AFB7",
                "#B13655",
                "#6E5E61",
                "#C7747B",
                "#C7BBBB",
                "#BE787B",
                "#F4F4F4",
                "#323232"
            ];

            document.addEventListener('DOMContentLoaded', () => {
                const initialPalette = document.getElementById('initial-palette');
                const popupPalette = document.getElementById('popup-palette');
                const selectedColorDiv = document.getElementById('selected-color');
                const largeImage = document.getElementById('large-img');
                const smallImages = document.querySelectorAll('.small-img');

                // Create initial 4 colors in the palette
                const initialColors = colorPalette.slice(0, 4);
                initialColors.forEach(color => {
                    const colorDiv = document.createElement('div');
                    colorDiv.className = 'shape';
                    colorDiv.style.background = color;
                    colorDiv.addEventListener('click', () => {
                        selectedColorDiv.style.background = color;
                        changeShirtColor(color);
                    });
                    initialPalette.appendChild(colorDiv);
                });

                // Create popup palette
                colorPalette.forEach(color => {
                    const colorDiv = document.createElement('div');
                    colorDiv.className = 'shape';
                    colorDiv.style.background = color;
                    colorDiv.addEventListener('click', () => {
                        selectedColorDiv.style.background = color;
                        changeShirtColor(color);
                        popupPalette.style.display = 'none';
                    });
                    popupPalette.appendChild(colorDiv);
                });

                // Show popup palette
                document.getElementById('show-palette').addEventListener('click', () => {
                    const paletteDisplay = popupPalette.style.display;
                    popupPalette.style.display = paletteDisplay === 'flex' ? 'none' : 'flex';
                });

                // Function to change the color of the shirt
                const changeShirtColor = (color) => {
                    const imgSrc = '/mnt/data/main-img.png';
                    const img = new Image();
                    img.src = imgSrc;
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.drawImage(img, 0, 0);

                        // Change the shirt color using a multiply blend mode
                        ctx.globalCompositeOperation = 'multiply';
                        ctx.fillStyle = color;
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        ctx.globalCompositeOperation = 'destination-in';
                        ctx.drawImage(img, 0, 0);

                        // Update the large image
                        largeImage.src = canvas.toDataURL();

                        // Update the small images
                        smallImages.forEach(smallImg => {
                            smallImg.src = canvas.toDataURL();
                        });
                    };
                };

                // Set initial selected color
                changeShirtColor('#F4F4F4');
            });
    </script>
</body>
</html>
